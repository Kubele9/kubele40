<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>KUBELE 40 – Jakub Gremmel • 20. 6. 2026</title>
  <meta name="description" content="Pozvánka a potvrzení účasti na 40. narozeniny Jakuba \"Kubele\" Gremmela – 20. 6. 2026, Sokolovna Brumovice 312." />
  <meta property="og:title" content="KUBELE 40 – 20. 6. 2026" />
  <meta property="og:description" content="Život začíná ve 40! Přijďte to oslavit se mnou. Potvrďte účast online." />
  <meta property="og:type" content="website" />
  <meta name="theme-color" content="#111" />
  <!-- Písmo: Cinzel (nadpisy) + Manrope (text) -->
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600;800&family=Manrope:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0a0a0a;
      --fg: #ffffff;
      --muted: #d9d9d9;
      --gold: #d4af37; /* elegant gold */
      --gold-dk: #a88922;
      --card: #111111;
      --border: #262626;
      --ok: #16a34a;
      --err: #ef4444;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      color: var(--fg);
      background: radial-gradient(1000px 600px at -20% -10%, #ffffff0a, transparent 60%),
                  radial-gradient(900px 600px at 120% -30%, #d4af3720, transparent 60%),
                  var(--bg);
      font-family: Manrope, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    }
    a { color: var(--gold); text-decoration: none; }
    a:hover { text-decoration: underline; }
    .wrap { max-width: 1100px; margin: 0 auto; padding: 24px; }

    /* Typography */
    .display { font-family: 'Cinzel', Georgia, serif; letter-spacing: .3px; }
    .title-xl { font-size: clamp(40px, 6vw, 72px); font-weight: 800; }
    .title-md { font-size: clamp(24px, 3vw, 36px); font-weight: 700; font-family: 'Cinzel', Georgia, serif; }
    .subtitle { color: var(--muted); font-size: clamp(16px, 2.2vw, 18px); }

    /* Common blocks */
    .card { background: linear-gradient(180deg, #0d0d0d, #0b0b0b); border: 1px solid var(--border); border-radius: 18px; padding: 20px; box-shadow: 0 10px 30px #0007; }
    .gold-line { height: 1px; background: linear-gradient(90deg, transparent, var(--gold), transparent); border: 0; margin: 14px 0 10px; }
    .muted { color: var(--muted); }

    /* Header */
    header.hero { display: grid; gap: 18px; align-items: center; padding: 36px 0 12px; text-align: center; }
    .chip { display: inline-flex; align-items: center; gap: 10px; padding: 8px 12px; border-radius: 999px; border: 1px solid var(--border); background: #0f0f0f; color: var(--gold); font-weight: 700; }

    /* Layout */
    .grid { display: grid; gap: 16px; grid-template-columns: 1fr; }
    @media (min-width: 980px) { .grid { grid-template-columns: 1.1fr .9fr; } }

    /* Rows */
    .row { display:grid; grid-template-columns: 120px 1fr; gap: 12px; padding: 10px 0; border-bottom: 1px dashed #222; }
    .row:last-child{ border-bottom:0; }

    /* Buttons */
    .btn { display:inline-flex; align-items:center; justify-content:center; gap:10px; padding:12px 16px; border-radius:12px; border:1px solid var(--border); background:#141414; color:var(--fg); cursor:pointer; font-weight:800; letter-spacing:.3px; }
    .btn:hover { filter: brightness(1.08); }
    .btn.gold { background: linear-gradient(180deg, var(--gold), var(--gold-dk)); color:#111; border-color:#805f11; text-shadow: 0 1px 0 #fff6; }
    .btn.ghost { background: transparent; }
    .btn.loading { opacity:.7; pointer-events:none; }

    /* Table */
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 10px 10px; border-bottom: 1px solid #1f1f1f; text-align: left; }
    th { color: var(--gold); font-weight: 700; }

    /* Form */
    form { display: grid; gap: 12px; }
    label { font-weight: 700; font-size: 14px; }
    input[type="text"], input[type="number"], select {
      width: 100%; background:#0d0d0d; border:1px solid #232323; color:var(--fg); padding:12px 14px; border-radius:12px; outline:none;
    }
    input:focus, select:focus{ border-color: var(--gold); box-shadow: 0 0 0 3px #d4af3733; }
    .inline { display:flex; gap:12px; flex-wrap:wrap; align-items:center; }

    .countdown { display:flex; gap:10px; justify-content:center; margin: 6px 0 0; }
    .pill { background:#0e0e0e; border:1px solid #222; border-radius:12px; padding:10px 12px; min-width:68px; text-align:center; }
    .pill .num{ font-size:22px; font-weight:800; color:var(--gold); }
    .pill .lbl{ font-size:12px; color:var(--muted); }

    footer { text-align:center; color: var(--muted); padding: 28px 0 8px; font-size: 14px; }

    /* Admin (hidden) */
    #admin { display:none; margin-top: 16px; }
    .hint { color: var(--muted); font-size: 13px; }

    /* Toast */
    .toast { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background:#0f0f0f; border:1px solid #1f1f1f; border-left:4px solid var(--ok); padding: 12px 14px; border-radius: 12px; color:#fff; box-shadow:0 10px 30px #0008; display:none; }
    .toast.err { border-left-color: var(--err); }
  </style>
</head>
<body>
  <div class="wrap">
    <!-- SEKCE I: HLAVIČKA A ZÁKLADNÍ INFO -->
    <header class="hero">
      <div class="chip display">🎉 KUBELE 40</div>
      <div class="title-xl display">Jakub Gremmel</div>
      <hr class="gold-line" />
      <p class="subtitle display">Život začíná ve 40! Přijďte to oslavit se mnou.</p>
      <div class="countdown" id="countdown" aria-live="polite"></div>
    </header>

    <section class="grid" aria-label="Detaily a potvrzení účasti">
      <!-- Detaily vlevo -->
      <article class="card" aria-labelledby="detaily-head">
        <h2 id="detaily-head" class="title-md display">Základní informace</h2>
        <div class="row"><div><strong>KDY</strong></div><div>Sobota 20. 6. 2026</div></div>
        <div class="row"><div><strong>KDE</strong></div><div>Sokolovna, Brumovice 312</div></div>
        <div class="row"><div><strong>ČAS</strong></div><div>Od 18:00</div></div>
        <div class="inline" style="margin-top:12px; gap:8px;">
          <button class="btn" id="addToCalendar">📅 Přidat do kalendáře (.ics)</button>
          <a class="btn ghost" id="mapLink" target="_blank" rel="noopener">🗺️ Navigovat – Brumovice 312 (Sokolovna)</a>
        </div>
      </article>

      <!-- Potvrzení účasti vpravo -->
      <article class="card" aria-labelledby="confirm-head">
        <h2 id="confirm-head" class="title-md display">Potvrzení účasti</h2>
        <p class="muted">Prosíme o potvrzení účasti <strong>nejpozději do 1. června 2026</strong>.</p>
        <div class="inline" style="margin-bottom:8px;">
          <a href="#confirmForm" class="btn gold">💥 POTVRDIT ÚČAST 💥</a>
        </div>
        <form id="confirmForm">
          <div>
            <label for="name">Jméno a příjmení *</label>
            <input id="name" name="name" type="text" required placeholder="Tvé jméno a příjmení" />
          </div>
          <div class="inline">
            <div style="flex:1; min-width:180px;">
              <label for="guests">Počet osob (včetně tebe)</label>
              <input id="guests" name="guests" type="number" min="1" max="20" value="1" />
            </div>
          </div>
          <div>
            <label>Přijdeš?</label>
            <div class="inline" role="group" aria-label="Potvrzení účasti">
              <label class="inline"><input type="radio" name="status" value="Dorazím" required /> <span>✔️ Dorazím</span></label>
              <label class="inline"><input type="radio" name="status" value="Dorazím – potřebuji ubytování" /> <span>🛏️ Dorazím – potřebuji ubytování</span></label>
              <label class="inline"><input type="radio" name="status" value="Ne" /> <span>❌ Bohužel nedorazím</span></label>
              <label class="inline"><input type="radio" name="status" value="Možná" /> <span>🤔 Ještě nevím</span></label>
            </div>
          </div>
          <div class="inline" style="margin-top:6px;">
            <button type="submit" class="btn gold" id="submitBtn">Odeslat potvrzení</button>
            <button type="button" class="btn" id="sendEmail">Poslat e‑mail pořadateli</button>
            <button type="reset" class="btn ghost">Vymazat</button>
          </div>
          <div class="hint">E‑mail hostů se nesbírá. Odpověď se uloží jen u pořadatele a ve tvém prohlížeči.</div>
        </form>
        <div id="thanks" class="muted" style="display:none; margin-top:10px;">Díky! Tvoje odpověď je uložená.</div>
      </article>
    </section>

    <!-- SEKCE III: PROGRAM -->
    <section class="card" style="margin-top:16px;" aria-labelledby="program-head">
      <h2 id="program-head" class="title-md display">Program (jídlo & zábava)</h2>
      <p class="muted">Program Oslavy: Maso, Pivo, DJ a Překvapení!</p>
      <div style="overflow:auto;">
        <table id="programTable">
          <thead>
            <tr><th>ČAS</th><th>CO SE BUDE DÍT</th><th>DETAIL</th></tr>
          </thead>
          <tbody>
            <tr><td>18:00</td><td>Vítejte!</td><td>Příchod a Welcome Drink.</td></tr>
            <tr><td>19:00</td><td>Slavnostní Raut</td><td>Maso, saláty, přílohy a dezerty.</td></tr>
            <tr><td>21:00</td><td>DJ a Taneční Parket</td><td>Za mixpultem DJ! Začínáme tančit.</td></tr>
            <tr><td>22:00</td><td>Speciální PŘEKVAPENÍ!</td><td>Bod programu, který si nesmíte nechat ujít.</td></tr>
            <tr><td>00:00</td><td>Půlnoční snack</td><td>Malé občerstvení pro ty nejvytrvalejší.</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- SEKCE IV: DÁRKY -->
    <section class="card" style="margin-top:16px;" aria-labelledby="gifts-head">
      <h2 id="gifts-head" class="title-md display">Dárky</h2>
      <p class="muted">Dárky? Děkuji, ale hlavně dorazte! Vaše účast je pro mě ten největší dar.</p>
      <p class="muted">Pokud byste přesto trvali na nějaké drobnosti, potěší mě cokoliv, co se dá vypít (láhev). Předem díky!</p>
    </section>

    <!-- Admin panel -->
    <section id="admin" class="card" aria-label="Seznam přihlášek (pořadatel)">
      <h2 class="title-md display">Pořadatel – přehled přihlášek</h2>
      <div class="inline" style="margin: 2px 0 12px;">
        <button class="btn" id="clearAll">🗑️ Smazat všechna lokální potvrzení</button>
      </div>
      <div class="hint">Panel je schovaný. Otevřeš/zavřeš ho zkratkou <strong>Shift + K</strong>.</div>
      <div style="overflow:auto;">
        <table id="applicationsTable" aria-describedby="admin"></table>
      </div>
    </section>

    <footer>
      Připraveno s radostí pro <strong>KUBELE 40</strong>. &middot; 20. 6. 2026 · Sokolovna, Brumovice 312
      <div class="hint">Pozn.: Po odeslání se odpověď uloží lokálně a (pokud je nastaveno) i do Google Sheets.</div>
    </footer>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

<script>
  // === Konfigurace ===
  const ORGANIZER_EMAIL = "jakub.gremmel@firma.seznam.cz"; // pouze pro tlačítko "Poslat e‑mail pořadateli"
  const EVENT_TITLE = "KUBELE 40 – Jakub Gremmel";
  const EVENT_LOCATION = "Sokolovna, Brumovice 312";
  const EVENT_START = new Date("2026-06-20T18:00:00+02:00");
  const EVENT_END   = new Date("2026-06-21T01:00:00+02:00");
  const DEADLINE = new Date("2026-06-01T23:59:59+02:00");
  const STORAGE_KEY = "kubele40_prihlasky_2026";
  const SHEETS_WEBAPP_URL = "https://script.google.com/macros/s/AKfycbyI76i3wfBA-0glpjgqemNGvlcAVbPorn8auWIdRmP7M1L-JhyI9UmTARrl52YcpgzN/exec"; // ← až vytvoříš (níže v návodu)

  // Dynamický odkaz na mapu
  const mapQ = encodeURIComponent(EVENT_LOCATION);
  document.getElementById('mapLink').href = `https://www.google.com/maps/search/?api=1&query=${mapQ}`;

  // === Pomocné ===
  const toastEl = document.getElementById('toast');
  function toast(msg, error=false){
    toastEl.textContent = msg; toastEl.classList.toggle('err', !!error); toastEl.style.display='block';
    setTimeout(() => (toastEl.style.display='none'), 2600);
  }

  // === Countdown ===
  const countdown = document.getElementById('countdown');
  function pad(n){ return String(n).padStart(2,'0'); }
  function tick() {
    const now = new Date();
    const target = EVENT_START;
    let diff = Math.max(0, target - now);
    const d = Math.floor(diff / (1000*60*60*24)); diff -= d*24*60*60*1000;
    const h = Math.floor(diff / (1000*60*60));    diff -= h*60*60*1000;
    const m = Math.floor(diff / (1000*60));       diff -= m*60*1000;
    const s = Math.floor(diff / 1000);
    countdown.innerHTML = `
      <div class="pill"><div class="num">${d}</div><div class="lbl">dní</div></div>
      <div class="pill"><div class="num">${h}</div><div class="lbl">hod</div></div>
      <div class="pill"><div class="num">${m}</div><div class="lbl">min</div></div>
      <div class="pill"><div class="num">${s}</div><div class="lbl">s</div></div>`;
  }
  tick(); setInterval(tick, 1000);

  // === ICS generátor ===
  function toICSDate(dt){
    const y = dt.getUTCFullYear();
    const mo = pad(dt.getUTCMonth()+1);
    const da = pad(dt.getUTCDate());
    const h = pad(dt.getUTCHours());
    const mi = pad(dt.getUTCMinutes());
    const s = pad(dt.getUTCSeconds());
    return `${y}${mo}${da}T${h}${mi}${s}Z`;
  }
  function buildICS(summary, description, location, start, end){
    const uid = `kubele40-${Date.now()}@invite`;
    const dtstamp = toICSDate(new Date());
    const ics = [
      'BEGIN:VCALENDAR',
      'VERSION:2.0',
      'PRODID:-//Kubele40 Invite//CS',
      'CALSCALE:GREGORIAN',
      'METHOD:PUBLISH',
      'BEGIN:VEVENT',
      `UID:${uid}`,
      `DTSTAMP:${dtstamp}`,
      `DTSTART:${toICSDate(start)}`,
      `DTEND:${toICSDate(end)}`,
      `SUMMARY:${summary}`,
      `DESCRIPTION:${description.replace(/
/g, '\n')}`,
      `LOCATION:${location}`,
      'END:VEVENT',
      'END:VCALENDAR' 
    ].join('
');
    return ics;
  }
  function download(filename, text, type='text/plain'){
    const blob = new Blob([text], {type:`${type};charset=utf-8`});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = filename; document.body.appendChild(a); a.click(); a.remove();
    URL.revokeObjectURL(url);
  }
  document.getElementById('addToCalendar').addEventListener('click', () => {
    const ics = buildICS(
      EVENT_TITLE,
      'Život začíná ve 40! Přijďte to oslavit se mnou.',
      EVENT_LOCATION,
      EVENT_START,
      EVENT_END
    );
    download('KUBELE40-20-06-2026.ics', ics, 'text/calendar');
  });

  // === Přihlášky – localStorage + Google Sheets (pokud nastavíš URL) ===
  function readItems(){ try { return JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]'); } catch { return []; } }
  function writeItems(items){ localStorage.setItem(STORAGE_KEY, JSON.stringify(items)); }
  function formToObj(form){
    const fd = new FormData(form);
    const obj = Object.fromEntries(fd.entries());
    obj.timestamp = new Date().toISOString();
    obj.stay = (obj.status || '').toLowerCase().includes('ubyt');
    return obj;
  }
  function refreshTable(){
    const t = document.getElementById('applicationsTable');
    const data = readItems();
    if(!data.length){ t.innerHTML = '<tr><td class="muted">Zatím žádné odpovědi…</td></tr>'; return; }
    const head = '<tr><th>Čas</th><th>Jméno</th><th>Status</th><th>Osob</th><th>Ubyt.</th></tr>';
    const rows = data.map(r => `<tr>
      <td>${new Date(r.timestamp).toLocaleString('cs-CZ')}</td>
      <td>${(r.name||'').replace(/</g,'&lt;')}</td>
      <td>${r.status||''}</td>
      <td>${r.guests||''}</td>
      <td>${r.stay ? 'Ano' : 'Ne'}</td>
    </tr>`).join('');
    t.innerHTML = head + rows;
  }

  const form = document.getElementById('confirmForm');
  const submitBtn = document.getElementById('submitBtn');
  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    if(new Date() > DEADLINE){ alert('Termín potvrzení (1. 6. 2026) již uplynul. Pokud chceš, napiš pořadateli e‑mail.'); return; }
    const item = formToObj(form);

    // 1) Lokální uložení (offline jistota)
    const items = readItems();
    items.push(item); writeItems(items); refreshTable();

    // 2) Odeslat do Google Sheets, pokud je nastaveno URL
    if(SHEETS_WEBAPP_URL && SHEETS_WEBAPP_URL.startsWith('http')){
      try{
        submitBtn.classList.add('loading');
        const res = await fetch(SHEETS_WEBAPP_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(item),
          mode: 'cors'
        });
        if(!res.ok) throw new Error('HTTP '+res.status);
        toast('Uloženo také do Google Sheets.');
      }catch(err){
        console.error(err);
        toast('Nepodařilo se uložit do Sheets (uloženo lokálně).', true);
      }finally{
        submitBtn.classList.remove('loading');
      }
    }

    document.getElementById('thanks').style.display = 'block';
    form.reset();
  });

  // E‑mail pořadateli (bez sběru e‑mailu hosta)
  function mailtoBody(o){
    return encodeURIComponent(
`Ahoj,

Potvrzení účasti na ${EVENT_TITLE}:

` +
`Jméno: ${o.name||''}
` +
`Status: ${o.status||''}
` +
`Počet osob: ${o.guests||''}
` +
`Ubytování: ${(o.stay ? 'Ano' : 'Ne')}

` +
`— Odesláno z webové pozvánky KUBELE 40`
    );
  }
  document.getElementById('sendEmail').addEventListener('click', () => {
    const o = formToObj(form);
    if(!o.name){ alert('Vyplň prosím své jméno.'); return; }
    if(!o.status){ alert('Vyber prosím, zda dorazíš.'); return; }
    const url = `mailto:${encodeURIComponent(ORGANIZER_EMAIL)}?subject=${encodeURIComponent('Potvrzení: ' + EVENT_TITLE)}&body=${mailtoBody(o)}`;
    window.location.href = url;
  });

  // Admin: zkratka Shift+K
  document.addEventListener('keydown', (e) => {
    if(e.shiftKey && (e.key === 'K' || e.key === 'k')){
      const el = document.getElementById('admin');
      el.style.display = el.style.display === 'none' || !el.style.display ? 'block' : 'none';
      if(el.style.display === 'block') refreshTable();
    }
  });

  // Admin: wipe
  document.getElementById('clearAll').addEventListener('click', () => {
    if(confirm('Opravdu smazat všechna lokální potvrzení? Tuto akci nelze vrátit.')){
      localStorage.removeItem(STORAGE_KEY); refreshTable();
    }
  });
</script>

<!--
ZDARMA NASAZENÍ + GOOGLE SHEETS NÁVOD (aktualizováno)
1) Hosting zdarma: GitHub Pages
   • Vytvoř repo „kubele40“, vlož tento soubor jako index.html a zapni Settings → Pages → Deploy from branch (main / /(root)).
   • Veřejná URL bude ve tvaru https://<tvoje‑jméno>.github.io/kubele40/

2) Google Sheets sběr zdarma (hotová tabulka + skript):
   • Připrav si prázdnou Google Tabulku a PŘEJMENUJ list na: Odpovědi
   • Do 1. řádku vlož hlavičky: timestamp | name | status | guests | stay (nebo vlož můj CSV – viz odkaz, nahrát do Sheets)
   • Otevři Extensions → Apps Script a vlož tento kód (nahradí původní):

function doPost(e){
  const ss = SpreadsheetApp.getActive();
  const sheetName = 'Odpovědi';
  const sheet = ss.getSheetByName(sheetName) || ss.insertSheet(sheetName);
  const HEADERS = ['timestamp','name','status','guests','stay'];
  if (sheet.getLastRow() === 0){ sheet.appendRow(HEADERS); }
  const data = JSON.parse(e.postData.contents || '{}');
  const stay = String(data.status||'').toLowerCase().includes('ubyt') ? 'Ano' : 'Ne';
  const row = [new Date(), data.name||'', data.status||'', data.guests||'', stay];
  sheet.appendRow(row);
  return ContentService.createTextOutput(JSON.stringify({ok:true}))
    .setMimeType(ContentService.MimeType.JSON);
}

   • Ulož → Deploy → New deployment → Type: Web app → Access: Anyone → Deploy.
   • Zkopíruj URL webové aplikace a vlož ji do proměnné SHEETS_WEBAPP_URL v tomto souboru.
   • Otevři svou veřejnou pozvánku a otestuj odeslání. V tabulce by měl přibýt nový řádek.

Poznámky:
- Pokud uvidíš v konzoli chybu CORS: v fetch už mám mode:'cors'; Apps Script Web App s Access: Anyone většinou funguje bez dalších hlaviček.
- Úložiště je zároveň i lokálně (localStorage), takže přehled v admin panelu (Shift+K) bude fungovat i offline.
- V případě potřeby můžeme později přidat ochranu (např. jednoduché heslo do admin panelu nebo honeypot u formuláře).
-->

</body>
</html>
